# DHCP configuration for Satellite PXE provisioning
# Generated by Ansible for automated node provisioning

# Global DHCP settings
option domain-name "{{ satellite_domain | default('prod.spg') }}";
option domain-name-servers {{ dns_servers | default(['10.168.0.1', '8.8.8.8']) | join(', ') }};
default-lease-time 600;
max-lease-time 7200;
ddns-update-style none;
authoritative;

# PXE boot options
option space PXE;
option PXE.mtftp-ip    code 1 = ip-address;
option PXE.mtftp-cport code 2 = unsigned integer 16;
option PXE.mtftp-sport code 3 = unsigned integer 16;
option PXE.mtftp-tmout code 4 = unsigned integer 8;
option PXE.mtftp-delay code 5 = unsigned integer 8;
option PXE.discovery-control code 6 = unsigned integer 8;
option PXE.discovery-mcast-addr code 7 = ip-address;

# Satellite network subnet configuration
subnet 10.168.0.0 netmask {{ netmask | default('255.255.0.0') }} {
    range {{ dhcp_range_start | default('10.168.1.100') }} {{ dhcp_range_end | default('10.168.1.200') }};
    option routers {{ gateway | default('10.168.0.1') }};
    option broadcast-address 10.168.255.255;
    
    # PXE boot configuration
    next-server {{ satellite_ip }};
    filename "pxelinux.0";
    
    # TFTP server configuration
    option tftp-server-name "{{ satellite_fqdn | default('satellite.prod.spg') }}";
    
    # Allow bootp and dynamic updates
    allow booting;
    allow bootp;
}

# Host reservations for known nodes
# Add specific host reservations here as needed
# host node001 {
#     hardware ethernet 52:54:00:12:34:56;
#     fixed-address 10.168.1.101;
#     option host-name "node001.prod.spg";
# }
