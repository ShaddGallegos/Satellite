---
# Main tasks for satellite_content role

- name: Include repository enablement
  ansible.builtin.include_tasks: enable_repositories.yml
  when: enable_rhel_repositories | bool
  tags: ['repositories']

- name: Include sync plan configuration
  ansible.builtin.include_tasks: configure_sync_plans.yml
  when: configure_sync_plans | bool
  tags: ['sync_plans']

- name: Include lifecycle environments
  ansible.builtin.include_tasks: create_lifecycle_environments.yml
  tags: ['lifecycle_environments']

- name: Include content views configuration
  ansible.builtin.include_tasks: create_content_views.yml
  when: create_content_views | bool
  tags: ['content_views']

- name: Include content view publishing
  ansible.builtin.include_tasks: publish_content_views.yml
  when: create_content_views | bool
  tags: ['publish_content_views']

- name: Include activation keys configuration
  ansible.builtin.include_tasks: create_activation_keys.yml
  when: create_activation_keys | bool
  tags: ['activation_keys']

- name: Display content configuration summary
  ansible.builtin.debug:
    msg: |
      SATELLITE CONTENT ROLE COMPLETE:
      
      Content Configuration:
      • Repositories: {{ 'Enabled' if enable_rhel_repositories else 'Skipped' }}
      • Content Views: {{ content_views | length }} created
      • Lifecycle Environments: {{ lifecycle_environments | length }} created
      • Activation Keys: {{ activation_keys | length }} created
      • Sync Plans: {{ 'Configured' if configure_sync_plans else 'Skipped' }}
      
      RHEL Versions Configured:
      {% for version in rhel_versions %}
      • RHEL {{ version }}: Content View and Activation Key ready
      {% endfor %}
      
      Ready for Node Registration and Provisioning!
  tags: ['summary']
